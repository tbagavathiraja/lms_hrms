
<div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 loading-icon" *ngIf="isLoading">
    <img src="assets/img/loading-large.gif" />
  </div>
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 success-message" *ngIf="!isLoading">
    <div class="alert alert-success" *ngIf="success">
      {{success_message}}.
    </div>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" *ngIf="!isLoading">

    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6"><h2>Permission Request</h2></div>
      <div class="col-xs-6 col-sm-4 col-md-4 col-lg-4 text-right margin-top-20px">
        <input type="text" formControlname="search" (keyup.enter)="getAllPermission()" placeholder="Search" class="form-control" [(ngModel)]="search" [ngModelOptions]="{standalone: true}">
      </div>
      <div class="col-xs-4 col-sm-1 col-md-1 col-lg-1 text-right margin-top-20px">
        <button type="button" (click)="getAllPermission()" class="btn btn-info btn-padding">
          <span class="glyphicon glyphicon-search hidden-xs"></span> Search
        </button>
      </div>
      <div class="col-xs-2 col-sm-1 col-md-1 col-lg-1 text-right">
        <h2><a class="font-30" [routerLink]="['/permission-request/add']" title="Request Permission"><i class="fa fa-plus-circle" aria-hidden="true"></i></a></h2>
      </div>
    </div>

  </div>
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 table-responsive" *ngIf="!isLoading && itemCount > 0">
    <data-table id="permission-grid" headerTitle="" *ngIf="itemCount>0" [indexColumn]="false" [items]="items" [substituteRows]="false" [limit]="10" [itemCount]="itemCount" (reload)="reloadItems($event)">
      <data-table-column [property]="'date'" [header]="'Date'" width="10%" [sortable]="true">
        <template #dataTableCell let-item="item">
          <div  class="text-right">{{item.date | date}}</div>
        </template>
      </data-table-column>
      <data-table-column [property]="'reason'" [header]="'Reason'" width="15%" [sortable]="true"></data-table-column>
      <data-table-column [property]="'from_time'" [header]="'From'" width="17%" [sortable]="true">
        <template #dataTableCell let-item="item">
          <div [textContent]="item.from_time"  class="text-right"></div>
        </template>
      </data-table-column>
      <data-table-column [property]="'to_time'" [header]="'To'" width="20%" [sortable]="true">
        <template #dataTableCell let-item="item">
          <div [textContent]="item.to_time"  class="text-right"></div>
        </template>
      </data-table-column>
      <data-table-column [property]="'status'" [header]="'Status'" width="10%" [sortable]="true">
        <ng-template #dataTableCell let-item="item">
          <label class="label" [ngClass]="{'label-success': item.status==='Granted','label-danger':item.status==='Rejected','label-info':item.status==='Initial'}">{{item.status}}</label>
        </ng-template>
      </data-table-column>
      <data-table-column [property]="'rejected_reason'" [header]="'Rejected Reason'" width="15%" [sortable]="true"></data-table-column>
      <data-table-column [property]="'Action'" [header]="'Action'" width="10%" [resizable]="true">
        <ng-template #dataTableCell let-item="item">
          <div class="text-center" *ngIf="item.status =='Initial'">
            <a  routerLink="/permission-request/edit/{{item.permission_id}}">
              <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
            </a>
            |
            <a (click)="delete_modal(item.permission_id,deleteModal)" title="Delete Permission"><i class="fa fa-trash-o" aria-hidden="true"></i></a>
          </div>
        </ng-template>
      </data-table-column>
    </data-table>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" *ngIf="!isLoading && itemCount ==0">
    <div class="well">
      <p class="text-center">No Permission Request Found</p>
    </div>
  </div>
</div>


<modal #deleteModal>
  <modal-header>
    <h3>Delete Confirmation</h3>
  </modal-header>
  <modal-content>
    <p>Are you sure want to delete Permission ? </p>
  </modal-content>
  <modal-footer>
    <button class="btn btn-danger" (click)="delete_confirm(deleteModal)">Delete</button>
    <button class="btn btn-close" (click)="deleteModal.close()">Close</button>
  </modal-footer>
</modal>




